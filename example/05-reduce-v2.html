<!DOCTYPE html>
<html>
  <head>
      <style>
          * {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
          }
        </style>
  </head>
  <body>
      <h2>Unit tests</h2>
      <h3 id="stats"></h3>
      <script src="../simpletest.js"></script>
      <script>
        /* TESTS FOR Array.prototype.reduce */

        /* INPUT
        reduce() signature
          reduce(array, callback[, initialValue])
        callback() signature
          callback(accumulator, currentValue[, currentIndex, array])
        */

        /* OUTPUT
        reduce() return value
          reduce() returns a single value. It can be a number, a string or an object. 
          (can be an array? a function? undefined? null?)
        */

        /* GENERIC DESCRIPTION
        The reduce() method executes a reducer function (that you provide) on each 
        member of the array resulting in a single output value.
        */

        /* REQUIREMENTS 

        kind of array
          standard 
            [1, 2, 3]
          sparse 
            [, 1, , 2]
          single element
            [1]
          single element and sparse
            [, 1]
          empty
            []
          empty and sparse
            [,,]

        Check reduce() inputs
          If no argument is passed to reduce() 
            throw a TypeError
          If no second argument, callback(), is passed to reduce()
            throw a TypeError
          If the second argument passed to reduce() is not of type Function
            throw a TypeError

          If array is standard, and initialValue is provided
            callback() should run array.length times
            accumulator should start with initialValue
            currentValue should start with first element in array
            reduce() should return a value

          If array is standard and no initialValue is provided
            callback() should run array.length -1, e.g. above 2, times
            accumulator should start with first element of array
            currentValue should start with second element in array
            reduce() should return a value

          If array is sparse, and initialValue is provided
            callback() should not be run on holes
            accumulator should start with initialValue
            reduce() should return a value

          If array is sparse and no initialValue is provided
            callback() should not be run on holes
            accumulator should start with first non hole element
            reduce() should return a value

          If array is empty and initialValue is provided
            reduce() should return initialValue without running callback

          If array is empty and no initialValue is provided
            reduce() should throw a TypeError

          If array has only 1 element and initialValue is provided
            
          If array has only 1 element and no initialValue is provided
            reduce() should return that without running callback

        */
        function reduce (array, callback, initialValue) {
          var length = array.length;
          var accumulator = initialValue;

          if (arguments.length === 0) {
            throw new TypeError('undefined is not an array');
          }

          if (Array.isArray(arguments[0]) === false) {
            throw new TypeError(typeof arguments[0] + ' is not an array');
          }

          if (typeof arguments[1] !== "function") {
            throw new TypeError(typeof arguments[1] + ' is not a function');
          }

          for (var i = 0; i < array.length; i++) {
            callback(accumulator);
          }
        }


        /* tests */
        SimpleTest.runTests({
          '01 - If no argument is passed to reduce(), throw a TypeError.': function () {
            var isTypeError = false;
            try {
              reduce();
            } catch (e) {
            isTypeError = e instanceof TypeError;
            };
            eq(isTypeError, true);
          },
          '02 - If the first argument passed to reduce() is not an array, throw a TypeError.': function () {
            var isTypeError = false;
            try {
              reduce(1)
            } catch (e) {
              isTypeError = e instanceof TypeError;
            };
            eq(isTypeError, true);
          },
          '03 - If the second argument passed to reduce() is not a function throw a TypeError.': function () {
            var isTypeError = false;
            try {
              reduce([], 2)
            } catch (e) {
              isTypeError = e instanceof TypeError;
            };
            eq(isTypeError, true);
          },
          '04 - If the first argument passed to reduce() is a standard array, and initialValue is provided, callback() should run array.length times.': function () {
            var numberOfTimesCallbackHasRun = 0;
            reduce([1, 2, 3], function () {
              numberOfTimesCallbackHasRun++;
            }, 0);
            eq(numberOfTimesCallbackHasRun, 3);
          },
          '05 - If the first argument passed to reduce() is a standard array, and initialValue is provided, accumulator should start with initialValue.': function () {
            reduce([1, 2, 3], function (accumulator) {
              eq(accumulator, 0);
            }, 0);
          },
          '06 - If the first argument passed to reduce() is a standard array, and initialValue is provided, accumulator should start with initialValue.': function () {
            fail();
            reduce([1, 2, 3], function (accumulator) {
              eq(accumulator, 0);
            }, 0);
          },

          
        });
      </script>
  </body>
</html>
